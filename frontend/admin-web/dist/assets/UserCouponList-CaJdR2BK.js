import{d as R}from"./coupon-DcJYIZcI.js";import{_ as F,r as m,h as P,c as q,o as S,b as e,w as a,d as n,E as N,i as G,j as H,f as v,g as s,t as p,k as J}from"./index-DU3ipqWQ.js";import"./request-CQPK_14F.js";const K={class:"user-coupon-list"},O={class:"stat-card"},Q={class:"stat-value text-primary"},W={class:"stat-card"},X={class:"stat-value text-success"},Y={class:"stat-card"},Z={class:"stat-value text-danger"},ee={class:"stat-card"},te={class:"stat-value"},ae={__name:"UserCouponList",setup(le){const y=m(!1),u=m({userId:"",couponName:"",useStatus:null}),i=m({unused:0,used:0,expired:0,total:0}),f=m([]),r=m({page:1,size:10,total:0}),V={1:"满减券",2:"折扣券",3:"代金券"},z={0:"未使用",1:"已使用",2:"已过期"},C=l=>V[l]||"未知",I=l=>({1:"success",2:"warning",3:"primary"})[l]||"",U=l=>z[l]||"未知",k=l=>({0:"primary",1:"success",2:"info"})[l]||"",D=l=>l.couponType===1?`减${l.discountAmount}元`:l.couponType===2?`${l.discountRate}折`:l.couponType===3?`${l.discountAmount}元`:"-",c=async()=>{y.value=!0;try{const l={userId:u.value.userId,couponName:u.value.couponName,status:u.value.useStatus,page:r.value.page-1,size:r.value.size},t=await R(l);t.success&&t.data?(f.value=t.data.records||[],r.value.total=t.data.total||0,t.data.stats&&(i.value=t.data.stats)):(f.value=[],r.value.total=0,N.error(t.message||"获取数据失败"))}catch(l){console.error("查询用户优惠券列表失败:",l),N.error("查询失败："+(l.message||"未知错误")),f.value=[],r.value.total=0}finally{y.value=!1}},B=()=>{u.value={userId:"",couponName:"",useStatus:null},c()};return P(()=>{c()}),(l,t)=>{const w=n("el-input"),g=n("el-form-item"),h=n("el-option"),M=n("el-select"),T=n("el-button"),j=n("el-form"),_=n("el-card"),b=n("el-col"),E=n("el-row"),d=n("el-table-column"),x=n("el-tag"),$=n("el-table"),A=n("el-pagination"),L=G("loading");return S(),q("div",K,[e(_,null,{header:a(()=>[...t[5]||(t[5]=[s("div",{class:"card-header"},[s("span",null,"用户优惠券")],-1)])]),default:a(()=>[e(j,{inline:!0,model:u.value,class:"search-form"},{default:a(()=>[e(g,{label:"用户名"},{default:a(()=>[e(w,{modelValue:u.value.userId,"onUpdate:modelValue":t[0]||(t[0]=o=>u.value.userId=o),placeholder:"请输入用户名或手机号",clearable:""},null,8,["modelValue"])]),_:1}),e(g,{label:"优惠券名称"},{default:a(()=>[e(w,{modelValue:u.value.couponName,"onUpdate:modelValue":t[1]||(t[1]=o=>u.value.couponName=o),placeholder:"请输入优惠券名称",clearable:""},null,8,["modelValue"])]),_:1}),e(g,{label:"使用状态"},{default:a(()=>[e(M,{modelValue:u.value.useStatus,"onUpdate:modelValue":t[2]||(t[2]=o=>u.value.useStatus=o),placeholder:"请选择状态",clearable:""},{default:a(()=>[e(h,{label:"未使用",value:0}),e(h,{label:"已使用",value:1}),e(h,{label:"已过期",value:2})]),_:1},8,["modelValue"])]),_:1}),e(g,null,{default:a(()=>[e(T,{type:"primary",onClick:c},{default:a(()=>[...t[6]||(t[6]=[v("查询",-1)])]),_:1}),e(T,{onClick:B},{default:a(()=>[...t[7]||(t[7]=[v("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),e(E,{gutter:20,style:{"margin-bottom":"20px"}},{default:a(()=>[e(b,{span:6},{default:a(()=>[e(_,{shadow:"hover"},{default:a(()=>[s("div",O,[t[8]||(t[8]=s("div",{class:"stat-label"},"未使用",-1)),s("div",Q,p(i.value.unused),1)])]),_:1})]),_:1}),e(b,{span:6},{default:a(()=>[e(_,{shadow:"hover"},{default:a(()=>[s("div",W,[t[9]||(t[9]=s("div",{class:"stat-label"},"已使用",-1)),s("div",X,p(i.value.used),1)])]),_:1})]),_:1}),e(b,{span:6},{default:a(()=>[e(_,{shadow:"hover"},{default:a(()=>[s("div",Y,[t[10]||(t[10]=s("div",{class:"stat-label"},"已过期",-1)),s("div",Z,p(i.value.expired),1)])]),_:1})]),_:1}),e(b,{span:6},{default:a(()=>[e(_,{shadow:"hover"},{default:a(()=>[s("div",ee,[t[11]||(t[11]=s("div",{class:"stat-label"},"总计",-1)),s("div",te,p(i.value.total),1)])]),_:1})]),_:1})]),_:1}),H((S(),J($,{data:f.value,border:"",style:{width:"100%"}},{default:a(()=>[e(d,{prop:"id",label:"ID",width:"80"}),e(d,{prop:"phone",label:"手机号",width:"120"}),e(d,{prop:"couponName",label:"优惠券名称",width:"180"}),e(d,{prop:"couponType",label:"类型",width:"100"},{default:a(o=>[e(x,{type:I(o.row.couponType)},{default:a(()=>[v(p(C(o.row.couponType)),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"discount",label:"优惠",width:"120"},{default:a(o=>[v(p(D(o.row)),1)]),_:1}),e(d,{prop:"receiveTime",label:"领取时间",width:"160"}),e(d,{prop:"validTo",label:"有效期至",width:"160"}),e(d,{prop:"useStatus",label:"状态",width:"100"},{default:a(o=>[e(x,{type:k(o.row.useStatus)},{default:a(()=>[v(p(U(o.row.useStatus)),1)]),_:2},1032,["type"])]),_:1}),e(d,{prop:"useTime",label:"使用时间",width:"160"}),e(d,{prop:"orderNo",label:"使用订单",width:"180"})]),_:1},8,["data"])),[[L,y.value]]),e(A,{"current-page":r.value.page,"onUpdate:currentPage":t[3]||(t[3]=o=>r.value.page=o),"page-size":r.value.size,"onUpdate:pageSize":t[4]||(t[4]=o=>r.value.size=o),total:r.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:c,onCurrentChange:c,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}},ue=F(ae,[["__scopeId","data-v-f632d6ef"]]);export{ue as default};
