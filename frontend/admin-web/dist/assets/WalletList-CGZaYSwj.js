import{r as $}from"./request-CPaEfZlY.js";import{_ as j,r as v,h as M,c as W,o as z,b as t,w as l,d as s,E as w,u as q,i as L,j as R,f as c,k as A,g as i,t as p,m as F}from"./index-Dl6qxkSp.js";function P(h){return $({url:"/wallet/list",method:"get",params:h})}const G={class:"wallet-list"},H={class:"amount"},J={class:"amount"},K={class:"amount"},O={class:"amount"},Q={__name:"WalletList",setup(h){const x=q(),g=v(!1),o=v({userId:"",phone:"",status:null}),_=v([]),n=v({page:1,size:10,total:0}),d=async()=>{g.value=!0;try{const u={userId:o.value.userId,phone:o.value.phone,status:o.value.status,page:n.value.page-1,size:n.value.size},e=await P(u);e.success&&e.data?(_.value=e.data.records||[],n.value.total=e.data.total||0):(_.value=[],n.value.total=0,w.error(e.message||"获取数据失败"))}catch(u){console.error("查询钱包列表失败:",u),w.error("查询失败："+(u.message||"未知错误")),_.value=[],n.value.total=0}finally{g.value=!1}},C=()=>{o.value={userId:"",phone:"",status:null},d()},V=u=>{x.push({path:"/wallet/transactions",query:{userId:u.userId}})},k=async u=>{const e=u.status===1?"冻结":"解冻";try{await F.confirm(`确定要${e}该钱包吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),w.success(`${e}成功`),d()}catch{}};return M(()=>{d()}),(u,e)=>{const b=s("el-input"),m=s("el-form-item"),y=s("el-option"),I=s("el-select"),f=s("el-button"),B=s("el-form"),r=s("el-table-column"),D=s("el-tag"),S=s("el-table"),T=s("el-pagination"),U=s("el-card"),E=L("loading");return z(),W("div",G,[t(U,null,{header:l(()=>[...e[5]||(e[5]=[i("div",{class:"card-header"},[i("span",null,"用户钱包管理")],-1)])]),default:l(()=>[t(B,{inline:!0,model:o.value,class:"search-form"},{default:l(()=>[t(m,{label:"用户名"},{default:l(()=>[t(b,{modelValue:o.value.userId,"onUpdate:modelValue":e[0]||(e[0]=a=>o.value.userId=a),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"手机号"},{default:l(()=>[t(b,{modelValue:o.value.phone,"onUpdate:modelValue":e[1]||(e[1]=a=>o.value.phone=a),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),t(m,{label:"钱包状态"},{default:l(()=>[t(I,{modelValue:o.value.status,"onUpdate:modelValue":e[2]||(e[2]=a=>o.value.status=a),placeholder:"请选择状态",clearable:"",style:{width:"150px"}},{default:l(()=>[t(y,{label:"正常",value:1}),t(y,{label:"冻结",value:0})]),_:1},8,["modelValue"])]),_:1}),t(m,null,{default:l(()=>[t(f,{type:"primary",onClick:d},{default:l(()=>[...e[6]||(e[6]=[c("查询",-1)])]),_:1}),t(f,{onClick:C},{default:l(()=>[...e[7]||(e[7]=[c("重置",-1)])]),_:1})]),_:1})]),_:1},8,["model"]),R((z(),A(S,{data:_.value,border:"",style:{width:"100%"}},{default:l(()=>[t(r,{prop:"id",label:"钱包ID",width:"80"}),t(r,{prop:"userName",label:"用户名",width:"120","show-overflow-tooltip":""}),t(r,{prop:"phone",label:"手机号",width:"120"}),t(r,{prop:"balance",label:"可用余额",width:"120"},{default:l(a=>[i("span",H,"¥"+p(a.row.balance),1)]),_:1}),t(r,{prop:"frozenBalance",label:"冻结金额",width:"120"},{default:l(a=>[i("span",J,"¥"+p(a.row.frozenBalance),1)]),_:1}),t(r,{prop:"totalDeposit",label:"累计充值",width:"120"},{default:l(a=>[i("span",K,"¥"+p(a.row.totalDeposit),1)]),_:1}),t(r,{prop:"totalConsumption",label:"累计消费",width:"120"},{default:l(a=>[i("span",O,"¥"+p(a.row.totalConsumption),1)]),_:1}),t(r,{prop:"status",label:"状态",width:"80"},{default:l(a=>[t(D,{type:a.row.status===1?"success":"danger"},{default:l(()=>[c(p(a.row.status===1?"正常":"冻结"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"createdAt",label:"创建时间",width:"160"}),t(r,{label:"操作",width:"180",fixed:"right"},{default:l(a=>[t(f,{type:"primary",size:"small",onClick:N=>V(a.row)},{default:l(()=>[...e[8]||(e[8]=[c(" 查看流水 ",-1)])]),_:1},8,["onClick"]),t(f,{type:a.row.status===1?"danger":"success",size:"small",onClick:N=>k(a.row)},{default:l(()=>[c(p(a.row.status===1?"冻结":"解冻"),1)]),_:2},1032,["type","onClick"])]),_:1})]),_:1},8,["data"])),[[E,g.value]]),t(T,{"current-page":n.value.page,"onUpdate:currentPage":e[3]||(e[3]=a=>n.value.page=a),"page-size":n.value.size,"onUpdate:pageSize":e[4]||(e[4]=a=>n.value.size=a),total:n.value.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:d,onCurrentChange:d,style:{"margin-top":"20px","justify-content":"flex-end"}},null,8,["current-page","page-size","total"])]),_:1})])}}},Z=j(Q,[["__scopeId","data-v-a2df5231"]]);export{Z as default};
